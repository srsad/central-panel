/**
 * Воркер для пересчета данных таблицы
 */

// Коофцент и результат для отчета сводных листов
const summarySheetPercent = {
  0: { percent: 0, result: 0 },
  1: { percent: 0, result: 0 },
  2: { percent: 0, result: 0 },
  3: { percent: 0, result: 0 },
  4: { percent: 0, result: 0 },
  5: { percent: 20.0, result: 1.0 },
  6: { percent: 18.33, result: 1.1 },
  7: { percent: 17.14, result: 1.2 },
  8: { percent: 16.25, result: 1.3 },
  9: { percent: 15.56, result: 1.4 },
  10: { percent: 15.0, result: 1.5 },
  11: { percent: 14.09, result: 1.55 },
  12: { percent: 13.33, result: 1.6 },
  13: { percent: 12.69, result: 1.65 },
  14: { percent: 12.14, result: 1.7 },
  15: { percent: 11.67, result: 1.75 },
  16: { percent: 11.25, result: 1.8 },
  17: { percent: 10.88, result: 1.85 },
  18: { percent: 10.56, result: 1.9 },
  19: { percent: 10.26, result: 1.95 },
  20: { percent: 10.0, result: 2.0 },
  21: { percent: 10.0, result: 2.1 },
  22: { percent: 10.0, result: 2.2 },
  23: { percent: 10.0, result: 2.3 },
  24: { percent: 10.0, result: 2.4 },
  25: { percent: 10.0, result: 2.5 },
  26: { percent: 10.0, result: 2.6 },
  27: { percent: 10.0, result: 2.7 },
  28: { percent: 10.0, result: 2.8 },
  29: { percent: 10.0, result: 2.9 },
  30: { percent: 10.0, result: 3.0 },
  31: { percent: 9.84, result: 3.05 },
  32: { percent: 9.69, result: 3.1 },
  33: { percent: 9.55, result: 3.15 },
  34: { percent: 9.41, result: 3.2 },
  35: { percent: 9.29, result: 3.25 },
  36: { percent: 9.17, result: 3.3 },
  37: { percent: 9.05, result: 3.35 },
  38: { percent: 8.95, result: 3.4 },
  39: { percent: 8.85, result: 3.45 },
  40: { percent: 8.75, result: 3.5 },
  41: { percent: 8.66, result: 3.55 },
  42: { percent: 8.57, result: 3.6 },
  43: { percent: 8.49, result: 3.65 },
  44: { percent: 8.41, result: 3.7 },
  45: { percent: 8.33, result: 3.75 },
  46: { percent: 8.26, result: 3.8 },
  47: { percent: 8.19, result: 3.85 },
  48: { percent: 8.13, result: 3.9 },
  49: { percent: 8.06, result: 3.95 },
  50: { percent: 8.0, result: 4.0 },
  51: { percent: 7.99, result: 4.075 },
  52: { percent: 7.98, result: 4.15 },
  53: { percent: 7.97, result: 4.224 },
  54: { percent: 7.96, result: 4.298 },
  55: { percent: 7.95, result: 4.298 },
  56: { percent: 7.94, result: 4.446 },
  57: { percent: 7.93, result: 4.52 },
  58: { percent: 7.92, result: 4.594 },
  59: { percent: 7.91, result: 4.667 },
  60: { percent: 7.9, result: 4.74 },
  61: { percent: 7.89, result: 4.813 },
  62: { percent: 7.88, result: 4.886 },
  63: { percent: 7.87, result: 4.958 },
  64: { percent: 7.86, result: 4.03 },
  65: { percent: 7.85, result: 4.103 },
  66: { percent: 7.84, result: 4.174 },
  67: { percent: 7.83, result: 5.246 },
  68: { percent: 7.82, result: 5.318 },
  69: { percent: 7.81, result: 5.389 },
  70: { percent: 7.80, result: 5.460 },
  71: { percent: 7.79, result: 5.531 },
  72: { percent: 7.78, result: 5.602 },
  73: { percent: 7.77, result: 5.672 },
  74: { percent: 7.76, result: 5.742 },
  75: { percent: 7.75, result: 5.813 },
  76: { percent: 7.74, result: 5.882 },
  77: { percent: 7.73, result: 5.952 },
  78: { percent: 7.72, result: 6.022 },
  79: { percent: 7.71, result: 6.091 },
  80: { percent: 7.70, result: 6.160 },
  81: { percent: 7.69, result: 6.229 },
  82: { percent: 7.68, result: 6.298 },
  83: { percent: 7.67, result: 6.366 },
  84: { percent: 7.66, result: 6.434 },
  85: { percent: 7.65, result: 6.503 },
  86: { percent: 7.64, result: 6.570 },
  87: { percent: 7.63, result: 6.638 },
  88: { percent: 7.62, result: 6.706 },
  89: { percent: 7.61, result: 6.773 },
  90: { percent: 7.60, result: 6.84 },
  91: { percent: 7.59, result: 6.907 },
  92: { percent: 7.58, result: 6.974 },
  93: { percent: 7.57, result: 7.040 },
  94: { percent: 7.56, result: 7.106 },
  95: { percent: 7.55, result: 7.173 },
  96: { percent: 7.54, result: 7.238 },
  97: { percent: 7.53, result: 7.304 },
  98: { percent: 7.52, result: 7.37 },
  99: { percent: 7.51, result: 7.435 },
  100: { percent: 7.50, result: 7.5 },
  101: { percent: 7.49, result: 7.565 },
  102: { percent: 7.48, result: 7.63 },
  103: { percent: 7.47, result: 7.694 },
  104: { percent: 7.46, result: 7.758 },
  105: { percent: 7.45, result: 7.823 },
  106: { percent: 7.44, result: 7.886 },
  107: { percent: 7.43, result: 7.95 },
  108: { percent: 7.42, result: 8.014 },
  109: { percent: 7.41, result: 8.077 },
  110: { percent: 7.40, result: 8.14 },
  111: { percent: 7.39, result: 8.203 },
  112: { percent: 7.38, result: 8.266 },
  113: { percent: 7.37, result: 8.328 },
  114: { percent: 7.36, result: 8.39 },
  115: { percent: 7.35, result: 8.453 },
  116: { percent: 7.34, result: 8.514 },
  117: { percent: 7.33, result: 8.576 },
  118: { percent: 7.32, result: 8.638 },
  119: { percent: 7.31, result: 8.699 },
  120: { percent: 7.30, result: 8.76 },
  121: { percent: 7.29, result: 8.821 },
  122: { percent: 7.28, result: 8.882 },
  123: { percent: 7.27, result: 8.942 },
  124: { percent: 7.26, result: 9.002 },
  125: { percent: 7.25, result: 9.063 },
  126: { percent: 7.24, result: 9.122 },
  127: { percent: 7.23, result: 9.182 },
  128: { percent: 7.22, result: 9.242 },
  129: { percent: 7.21, result: 9.301 },
  130: { percent: 7.20, result: 9.36 },
  131: { percent: 7.19, result: 9.419 },
  132: { percent: 7.18, result: 9.478 },
  133: { percent: 7.17, result: 9.536 },
  134: { percent: 7.16, result: 9.594 },
  135: { percent: 7.15, result: 9.653 },
  136: { percent: 7.14, result: 9.71 },
  137: { percent: 7.13, result: 9.768 },
  138: { percent: 7.12, result: 9.826 },
  139: { percent: 7.11, result: 9.883 },
  140: { percent: 7.10, result: 9.94 },
  141: { percent: 7.09, result: 9.997 },
  142: { percent: 7.08, result: 10.054 },
  143: { percent: 7.07, result: 10.11 },
  144: { percent: 7.06, result: 10.166 },
  145: { percent: 7.05, result: 10.223 },
  146: { percent: 7.04, result: 10.278 },
  147: { percent: 7.03, result: 10.334 },
  148: { percent: 7.02, result: 10.39 },
  149: { percent: 7.01, result: 10.445 },
  150: { percent: 7.00, result: 10.5 },
  151: { percent: 6.99, result: 10.555 },
  152: { percent: 6.98, result: 10.61 },
  153: { percent: 6.97, result: 10.664 },
  154: { percent: 6.96, result: 10.718 },
  155: { percent: 6.95, result: 10.773 },
  156: { percent: 6.94, result: 10.826 },
  157: { percent: 6.93, result: 10.88 },
  158: { percent: 6.92, result: 10.934 },
  159: { percent: 6.91, result: 10.987 },
  160: { percent: 6.90, result: 11.04 },
  161: { percent: 6.89, result: 11.093 },
  162: { percent: 6.88, result: 11.146 },
  163: { percent: 6.87, result: 11.198 },
  164: { percent: 6.86, result: 11.25 },
  165: { percent: 6.85, result: 11.303 },
  166: { percent: 6.84, result: 11.354 },
  167: { percent: 6.83, result: 11.406 },
  168: { percent: 6.82, result: 11.458 },
  169: { percent: 6.81, result: 11.509 },
  170: { percent: 6.80, result: 11.56 },
  171: { percent: 6.79, result: 11.611 },
  172: { percent: 6.78, result: 11.662 },
  173: { percent: 6.77, result: 11.712 },
  174: { percent: 6.76, result: 11.762 },
  175: { percent: 6.75, result: 11.813 },
  176: { percent: 6.74, result: 11.862 },
  177: { percent: 6.73, result: 11.912 },
  178: { percent: 6.72, result: 11.962 },
  179: { percent: 6.71, result: 12.011 },
  180: { percent: 6.70, result: 12.06 },
  181: { percent: 6.69, result: 12.109 },
  182: { percent: 6.68, result: 12.158 },
  183: { percent: 6.67, result: 12.206 },
  184: { percent: 6.66, result: 12.254 },
  185: { percent: 6.65, result: 12.303 },
  186: { percent: 6.64, result: 12.35 },
  187: { percent: 6.63, result: 12.398 },
  188: { percent: 6.62, result: 12.446 },
  189: { percent: 6.61, result: 12.493 },
  190: { percent: 6.60, result: 12.54 },
  191: { percent: 6.59, result: 12.587 },
  192: { percent: 6.58, result: 12.634 },
  193: { percent: 6.57, result: 12.68 },
  194: { percent: 6.56, result: 12.726 },
  195: { percent: 6.55, result: 12.773 },
  196: { percent: 6.54, result: 12.818 },
  197: { percent: 6.53, result: 12.864 },
  198: { percent: 6.52, result: 12.91 },
  199: { percent: 6.51, result: 12.955 },
  200: { percent: 6.5, result: 13.0 },
  201: { percent: 6.49, result: 13.045 },
  202: { percent: 6.48, result: 13.09 },
  203: { percent: 6.47, result: 13.134 },
  204: { percent: 6.46, result: 13.178 },
  205: { percent: 6.45, result: 13.223 },
  206: { percent: 6.44, result: 13.266 },
  207: { percent: 6.43, result: 13.31 },
  208: { percent: 6.42, result: 13.354 },
  209: { percent: 6.41, result: 13.397 },
  210: { percent: 6.40, result: 13.44 },
  211: { percent: 6.39, result: 13.483 },
  212: { percent: 6.38, result: 13.526 },
  213: { percent: 6.37, result: 13.568 },
  214: { percent: 6.36, result: 13.61 },
  215: { percent: 6.35, result: 13.653 },
  216: { percent: 6.34, result: 13.694 },
  217: { percent: 6.33, result: 13.736 },
  218: { percent: 6.32, result: 13.778 },
  219: { percent: 6.31, result: 13.819 },
  220: { percent: 6.30, result: 13.86 },
  221: { percent: 6.29, result: 13.901 },
  222: { percent: 6.28, result: 13.942 },
  223: { percent: 6.27, result: 13.982 },
  224: { percent: 6.26, result: 14.022 },
  225: { percent: 6.25, result: 14.063 },
  226: { percent: 6.24, result: 14.102 },
  227: { percent: 6.23, result: 14.142 },
  228: { percent: 6.22, result: 14.182 },
  229: { percent: 6.21, result: 14.221 },
  230: { percent: 6.20, result: 14.26 },
  231: { percent: 6.19, result: 14.299 },
  232: { percent: 6.18, result: 14.338 },
  233: { percent: 6.17, result: 14.376 },
  234: { percent: 6.16, result: 14.414 },
  235: { percent: 6.15, result: 14.453 },
  236: { percent: 6.14, result: 14.49 },
  237: { percent: 6.13, result: 14.528 },
  238: { percent: 6.12, result: 14.566 },
  239: { percent: 6.11, result: 14.603 },
  240: { percent: 6.10, result: 14.64 },
  241: { percent: 6.09, result: 14.677 },
  242: { percent: 6.08, result: 14.714 },
  243: { percent: 6.07, result: 14.75 },
  244: { percent: 6.06, result: 14.786 },
  245: { percent: 6.05, result: 14.822 },
  246: { percent: 6.04, result: 14.858 },
  247: { percent: 6.03, result: 14.894 },
  248: { percent: 6.02, result: 14.93 },
  249: { percent: 6.01, result: 14.965 },
  250: { percent: 6.00, result: 15.0 },
  251: { percent: 5.99, result: 15.035 },
  252: { percent: 5.98, result: 15.07 },
  253: { percent: 5.97, result: 15.104 },
  254: { percent: 5.96, result: 15.138 },
  255: { percent: 5.95, result: 15.172 },
  256: { percent: 5.94, result: 15.206 },
  257: { percent: 5.93, result: 15.24 },
  258: { percent: 5.92, result: 15.274 },
  259: { percent: 5.91, result: 15.307 },
  260: { percent: 5.90, result: 15.34 },
  261: { percent: 5.89, result: 15.373 },
  262: { percent: 5.88, result: 15.406 },
  263: { percent: 5.87, result: 15.438 },
  264: { percent: 5.86, result: 15.470 },
  265: { percent: 5.85, result: 15.502 },
  266: { percent: 5.84, result: 15.534 },
  267: { percent: 5.83, result: 15.566 },
  268: { percent: 5.82, result: 15.598 },
  269: { percent: 5.81, result: 15.629 },
  270: { percent: 5.80, result: 15.66 },
  271: { percent: 5.79, result: 15.691 },
  272: { percent: 5.78, result: 15.722 },
  273: { percent: 5.77, result: 15.752 },
  274: { percent: 5.76, result: 15.782 },
  275: { percent: 5.75, result: 15.812 },
  276: { percent: 5.74, result: 15.842 },
  277: { percent: 5.73, result: 15.872 },
  278: { percent: 5.72, result: 15.902 },
  279: { percent: 5.71, result: 15.931 },
  280: { percent: 5.70, result: 15.96 },
  281: { percent: 5.69, result: 15.989 },
  282: { percent: 5.68, result: 16.018 },
  283: { percent: 5.67, result: 16.046 },
  284: { percent: 5.66, result: 16.074 },
  285: { percent: 5.65, result: 16.102 },
  286: { percent: 5.64, result: 16.13 },
  287: { percent: 5.63, result: 16.158 },
  288: { percent: 5.62, result: 16.186 },
  289: { percent: 5.61, result: 16.213 },
  290: { percent: 5.60, result: 16.24 },
  291: { percent: 5.59, result: 16.267 },
  292: { percent: 5.58, result: 16.294 },
  293: { percent: 5.57, result: 16.32 },
  294: { percent: 5.56, result: 16.346 },
  295: { percent: 5.55, result: 16.372 },
  296: { percent: 5.54, result: 16.398 },
  297: { percent: 5.53, result: 16.424 },
  298: { percent: 5.52, result: 16.45 },
  299: { percent: 5.51, result: 16.475 },
  300: { percent: 5.50, result: 16.5 },
  301: { percent: 5.49, result: 16.525 },
  302: { percent: 5.48, result: 16.55 },
  303: { percent: 5.47, result: 16.574 },
  304: { percent: 5.46, result: 16.598 },
  305: { percent: 5.45, result: 16.623 },
  306: { percent: 5.44, result: 16.646 },
  307: { percent: 5.43, result: 16.670 },
  308: { percent: 5.42, result: 16.694 },
  309: { percent: 5.41, result: 16.717 },
  310: { percent: 5.40, result: 16.740 },
  311: { percent: 5.39, result: 16.763 },
  312: { percent: 5.38, result: 16.786 },
  313: { percent: 5.37, result: 16.808 },
  314: { percent: 5.36, result: 16.830 },
  315: { percent: 5.35, result: 16.853 },
  316: { percent: 5.34, result: 16.874 },
  317: { percent: 5.33, result: 16.896 },
  318: { percent: 5.32, result: 16.918 },
  319: { percent: 5.31, result: 16.939 },
  320: { percent: 5.30, result: 16.960 },
  321: { percent: 5.29, result: 16.981 },
  322: { percent: 5.28, result: 17.002 },
  323: { percent: 5.27, result: 17.022 },
  324: { percent: 5.26, result: 17.042 },
  325: { percent: 5.25, result: 17.063 },
  326: { percent: 5.24, result: 17.082 },
  327: { percent: 5.23, result: 17.102 },
  328: { percent: 5.22, result: 17.122 },
  329: { percent: 5.21, result: 17.141 },
  330: { percent: 5.20, result: 17.160 },
  331: { percent: 5.19, result: 17.179 },
  332: { percent: 5.18, result: 17.198 },
  333: { percent: 5.17, result: 17.216 },
  334: { percent: 5.16, result: 17.234 },
  335: { percent: 5.15, result: 17.253 },
  336: { percent: 5.14, result: 17.270 },
  337: { percent: 5.13, result: 17.288 },
  338: { percent: 5.12, result: 17.306 },
  339: { percent: 5.11, result: 17.323 },
  340: { percent: 5.10, result: 17.340 },
  341: { percent: 5.09, result: 17.357 },
  342: { percent: 5.08, result: 17.374 },
  343: { percent: 5.07, result: 17.390 },
  344: { percent: 5.06, result: 17.406 },
  345: { percent: 5.05, result: 17.423 },
  346: { percent: 5.04, result: 17.438 },
  347: { percent: 5.03, result: 17.454 },
  348: { percent: 5.02, result: 17.470 },
  349: { percent: 5.01, result: 17.485 },
  350: { percent: 5.00, result: 17.500 },
  351: { percent: 4.99, result: 17.515 },
  352: { percent: 4.98, result: 17.530 },
  353: { percent: 4.97, result: 17.544 },
  354: { percent: 4.96, result: 17.558 },
  355: { percent: 4.95, result: 17.573 },
  356: { percent: 4.94, result: 17.586 },
  357: { percent: 4.93, result: 17.600 },
  358: { percent: 4.92, result: 17.614 },
  359: { percent: 4.91, result: 17.627 },
  360: { percent: 4.90, result: 17.640 },
  361: { percent: 4.89, result: 17.653 },
  362: { percent: 4.88, result: 17.666 },
  363: { percent: 4.87, result: 17.678 },
  364: { percent: 4.86, result: 17.690 },
  365: { percent: 4.85, result: 17.703 },
  366: { percent: 4.84, result: 17.714 },
  367: { percent: 4.83, result: 17.726 },
  368: { percent: 4.82, result: 17.738 },
  369: { percent: 4.81, result: 17.749 },
  370: { percent: 4.80, result: 17.760 },
  371: { percent: 4.79, result: 17.771 },
  372: { percent: 4.78, result: 17.782 },
  373: { percent: 4.77, result: 17.792 },
  374: { percent: 4.76, result: 17.802 },
  375: { percent: 4.75, result: 17.813 },
  376: { percent: 4.74, result: 17.822 },
  377: { percent: 4.73, result: 17.832 },
  378: { percent: 4.72, result: 17.842 },
  379: { percent: 4.71, result: 17.851 },
  380: { percent: 4.70, result: 17.860 },
  381: { percent: 4.69, result: 17.869 },
  382: { percent: 4.68, result: 17.878 },
  383: { percent: 4.67, result: 17.886 },
  384: { percent: 4.66, result: 17.894 },
  385: { percent: 4.65, result: 17.903 },
  386: { percent: 4.64, result: 17.910 },
  387: { percent: 4.63, result: 17.918 },
  388: { percent: 4.62, result: 17.926 },
  389: { percent: 4.61, result: 17.933 },
  390: { percent: 4.60, result: 17.940 },
  391: { percent: 4.59, result: 17.947 },
  392: { percent: 4.58, result: 17.954 },
  393: { percent: 4.57, result: 17.960 },
  394: { percent: 4.56, result: 17.966 },
  395: { percent: 4.55, result: 17.973 },
  396: { percent: 4.54, result: 17.978 },
  397: { percent: 4.53, result: 17.984 },
  398: { percent: 4.52, result: 17.990 },
  399: { percent: 4.51, result: 17.995 },
  400: { percent: 4.50, result: 18.000 },
  401: { percent: 4.5, result: 18.045 },
  402: { percent: 4.49, result: 18.05 },
  403: { percent: 4.49, result: 18.095 },
  404: { percent: 4.48, result: 18.099 },
  405: { percent: 4.48, result: 18.144 },
  406: { percent: 4.47, result: 18.164 },
  407: { percent: 4.47, result: 18.191 },
  408: { percent: 4.46, result: 18.217 },
  409: { percent: 4.46, result: 18.224 },
  410: { percent: 4.45, result: 18.25 },
  411: { percent: 4.45, result: 18.275 },
  412: { percent: 4.44, result: 18.301 },
  413: { percent: 4.44, result: 18.327 },
  414: { percent: 4.43, result: 18.352 },
  415: { percent: 4.43, result: 18.377 },
  416: { percent: 4.42, result: 18.403 },
  417: { percent: 4.42, result: 18.428 },
  418: { percent: 4.41, result: 18.453 },
  419: { percent: 4.41, result: 18.459 },
  420: { percent: 4.4, result: 18.484 },
  421: { percent: 4.4, result: 18.508 },
  422: { percent: 4.39, result: 18.533 },
  423: { percent: 4.39, result: 18.558 },
  424: { percent: 4.38, result: 18.582 },
  425: { percent: 4.38, result: 18.607 },
  426: { percent: 4.37, result: 18.631 },
  427: { percent: 4.37, result: 18.655 },
  428: { percent: 4.36, result: 18.679 },
  429: { percent: 4.36, result: 18.684 },
  430: { percent: 4.35, result: 18.707 },
  431: { percent: 4.35, result: 18.731 },
  432: { percent: 4.34, result: 18.755 },
  433: { percent: 4.34, result: 18.779 },
  434: { percent: 4.33, result: 18.802 },
  435: { percent: 4.33, result: 18.826 },
  436: { percent: 4.32, result: 18.849 },
  437: { percent: 4.32, result: 18.872 },
  438: { percent: 4.31, result: 18.895 },
  439: { percent: 4.31, result: 18.918 },
  440: { percent: 4.30, result: 18.941 },
  441: { percent: 4.30, result: 18.944 },
  442: { percent: 4.29, result: 18.967 },
  443: { percent: 4.29, result: 18.99 },
  444: { percent: 4.28, result: 19.012 },
  445: { percent: 4.28, result: 19.035 },
  446: { percent: 4.27, result: 19.057 },
  447: { percent: 4.27, result: 19.079 },
  448: { percent: 4.26, result: 19.101 },
  449: { percent: 4.26, result: 19.124 },
  450: { percent: 4.25, result: 19.146 },
  451: { percent: 4.25, result: 19.147 },
  452: { percent: 4.24, result: 19.169 },
  453: { percent: 4.24, result: 19.19 },
  454: { percent: 4.23, result: 19.212 },
  455: { percent: 4.23, result: 19.234 },
  456: { percent: 4.22, result: 19.255 },
  457: { percent: 4.22, result: 19.276 },
  458: { percent: 4.21, result: 19.298 },
  459: { percent: 4.21, result: 19.319 },
  460: { percent: 4.20, result: 19.34 },
  461: { percent: 4.20, result: 19.34 },
  462: { percent: 4.19, result: 19.36 },
  463: { percent: 4.19, result: 19.381 },
  464: { percent: 4.18, result: 19.402 },
  465: { percent: 4.18, result: 19.422 },
  466: { percent: 4.17, result: 19.443 },
  467: { percent: 4.17, result: 19.463 },
  468: { percent: 4.16, result: 19.484 },
  469: { percent: 4.16, result: 19.504 },
  470: { percent: 4.15, result: 19.524 },
  471: { percent: 4.15, result: 19.544 },
  472: { percent: 4.14, result: 19.564 },
  473: { percent: 4.14, result: 19.562 },
  474: { percent: 4.13, result: 19.582 },
  475: { percent: 4.13, result: 19.601 },
  476: { percent: 4.12, result: 19.621 },
  477: { percent: 4.12, result: 19.64 },
  478: { percent: 4.11, result: 19.659 },
  479: { percent: 4.11, result: 19.679 },
  480: { percent: 4.10, result: 19.698 },
  481: { percent: 4.10, result: 19.717 },
  482: { percent: 4.09, result: 19.736 },
  483: { percent: 4.09, result: 19.733 },
  484: { percent: 4.08, result: 19.751 },
  485: { percent: 4.08, result: 19.77 },
  486: { percent: 4.07, result: 19.789 },
  487: { percent: 4.07, result: 19.807 },
  488: { percent: 4.06, result: 19.825 },
  489: { percent: 4.06, result: 19.844 },
  490: { percent: 4.05, result: 19.862 },
  491: { percent: 4.05, result: 19.88 },
  492: { percent: 4.04, result: 19.898 },
  493: { percent: 4.04, result: 19.938 },
  494: { percent: 4.03, result: 19.925 },
  495: { percent: 4.03, result: 19.949 },
  496: { percent: 4.02, result: 19.958 },
  497: { percent: 4.02, result: 19.982 },
  498: { percent: 4.01, result: 19.97 },
  499: { percent: 4.01, result: 20.01 },
  500: { percent: 4.0, result: 20.0 },
  501: { percent: 4.00, result: 20.04 },
  502: { percent: 4.00, result: 20.080 },
  503: { percent: 4.00, result: 20.12 },
  504: { percent: 4.00, result: 20.16 },
  505: { percent: 4.00, result: 20.2 },
  506: { percent: 4.00, result: 20.24 },
  507: { percent: 4.00, result: 20.28 },
  508: { percent: 4.00, result: 20.32 },
  509: { percent: 4.00, result: 20.36 },
  510: { percent: 3.95, result: 20.145 },
  511: { percent: 3.95, result: 20.185 },
  512: { percent: 3.95, result: 20.224 },
  513: { percent: 3.95, result: 20.264 },
  514: { percent: 3.95, result: 20.303 },
  515: { percent: 3.95, result: 20.343 },
  516: { percent: 3.95, result: 20.382 },
  517: { percent: 3.95, result: 20.422 },
  518: { percent: 3.95, result: 20.461 },
  519: { percent: 3.95, result: 20.501 },
  520: { percent: 3.95, result: 20.54 },
  521: { percent: 3.95, result: 20.58 },
  522: { percent: 3.95, result: 20.619 },
  523: { percent: 3.95, result: 20.659 },
  524: { percent: 3.95, result: 20.698 },
  525: { percent: 3.95, result: 20.738 },
  526: { percent: 3.95, result: 20.777 },
  527: { percent: 3.95, result: 20.817 },
  528: { percent: 3.95, result: 20.856 },
  529: { percent: 3.95, result: 20.896 },
  530: { percent: 3.90, result: 20.67 },
  531: { percent: 3.90, result: 20.709 },
  532: { percent: 3.90, result: 20.748 },
  533: { percent: 3.90, result: 20.787 },
  534: { percent: 3.90, result: 20.826 },
  535: { percent: 3.90, result: 20.865 },
  536: { percent: 3.90, result: 20.904 },
  537: { percent: 3.90, result: 20.943 },
  538: { percent: 3.90, result: 20.982 },
  539: { percent: 3.90, result: 21.021 },
  540: { percent: 3.90, result: 21.06 },
  541: { percent: 3.90, result: 21.099 },
  542: { percent: 3.90, result: 21.138 },
  543: { percent: 3.90, result: 21.177 },
  544: { percent: 3.90, result: 21.216 },
  545: { percent: 3.90, result: 21.255 },
  546: { percent: 3.90, result: 21.294 },
  547: { percent: 3.90, result: 21.333 },
  548: { percent: 3.90, result: 21.372 },
  549: { percent: 3.90, result: 21.411 },
  550: { percent: 3.85, result: 21.175 },
  551: { percent: 3.85, result: 21.214 },
  552: { percent: 3.85, result: 21.252 },
  553: { percent: 3.85, result: 21.291 },
  554: { percent: 3.85, result: 21.329 },
  555: { percent: 3.85, result: 21.368 },
  556: { percent: 3.85, result: 21.406 },
  557: { percent: 3.85, result: 21.445 },
  558: { percent: 3.85, result: 21.483 },
  559: { percent: 3.85, result: 21.522 },
  560: { percent: 3.85, result: 21.56 },
  561: { percent: 3.85, result: 21.599 },
  562: { percent: 3.85, result: 21.637 },
  563: { percent: 3.85, result: 21.676 },
  564: { percent: 3.85, result: 21.714 },
  565: { percent: 3.85, result: 21.753 },
  566: { percent: 3.85, result: 21.791 },
  567: { percent: 3.85, result: 21.83 },
  568: { percent: 3.85, result: 21.868 },
  569: { percent: 3.85, result: 21.907 },
  570: { percent: 3.80, result: 21.66 },
  571: { percent: 3.80, result: 21.698 },
  572: { percent: 3.80, result: 21.736 },
  573: { percent: 3.80, result: 21.774 },
  574: { percent: 3.80, result: 21.812 },
  575: { percent: 3.80, result: 21.85 },
  576: { percent: 3.80, result: 21.888 },
  577: { percent: 3.80, result: 21.926 },
  578: { percent: 3.80, result: 21.964 },
  579: { percent: 3.80, result: 22.002 },
  580: { percent: 3.80, result: 22.04 },
  581: { percent: 3.80, result: 22.078 },
  582: { percent: 3.80, result: 22.116 },
  583: { percent: 3.80, result: 22.154 },
  584: { percent: 3.80, result: 22.192 },
  585: { percent: 3.80, result: 22.23 },
  586: { percent: 3.80, result: 22.268 },
  587: { percent: 3.80, result: 22.306 },
  588: { percent: 3.80, result: 22.344 },
  589: { percent: 3.80, result: 22.382 },
  590: { percent: 3.75, result: 22.125 },
  591: { percent: 3.75, result: 22.163 },
  592: { percent: 3.75, result: 22.2 },
  593: { percent: 3.75, result: 22.238 },
  594: { percent: 3.75, result: 22.275 },
  595: { percent: 3.75, result: 22.313 },
  596: { percent: 3.75, result: 22.35 },
  597: { percent: 3.75, result: 22.388 },
  598: { percent: 3.75, result: 22.425 },
  599: { percent: 3.75, result: 22.463 },
  600: { percent: 3.75, result: 22.5 },
  601: { percent: 3.75, result: 22.538 },
  602: { percent: 3.75, result: 22.575 },
  603: { percent: 3.75, result: 22.613 },
  604: { percent: 3.75, result: 22.65 },
  605: { percent: 3.75, result: 22.688 },
  606: { percent: 3.75, result: 22.725 },
  607: { percent: 3.75, result: 22.763 },
  608: { percent: 3.75, result: 22.8 },
  609: { percent: 3.75, result: 22.838 },
  610: { percent: 3.70, result: 22.57 },
  611: { percent: 3.70, result: 22.607 },
  612: { percent: 3.70, result: 22.644 },
  613: { percent: 3.70, result: 22.681 },
  614: { percent: 3.70, result: 22.718 },
  615: { percent: 3.70, result: 22.755 },
  616: { percent: 3.70, result: 22.792 },
  617: { percent: 3.70, result: 22.829 },
  618: { percent: 3.70, result: 22.866 },
  619: { percent: 3.70, result: 22.903 },
  620: { percent: 3.70, result: 22.94 },
  621: { percent: 3.70, result: 22.977 },
  622: { percent: 3.70, result: 23.014 },
  623: { percent: 3.70, result: 23.051 },
  624: { percent: 3.70, result: 23.088 },
  625: { percent: 3.70, result: 23.125 },
  626: { percent: 3.70, result: 23.162 },
  627: { percent: 3.70, result: 23.199 },
  628: { percent: 3.70, result: 23.236 },
  629: { percent: 3.70, result: 23.273 },
  630: { percent: 3.65, result: 22.995 },
  631: { percent: 3.65, result: 23.032 },
  632: { percent: 3.65, result: 23.068 },
  633: { percent: 3.65, result: 23.105 },
  634: { percent: 3.65, result: 23.141 },
  635: { percent: 3.65, result: 23.178 },
  636: { percent: 3.65, result: 23.214 },
  637: { percent: 3.65, result: 23.251 },
  638: { percent: 3.65, result: 23.287 },
  639: { percent: 3.65, result: 23.324 },
  640: { percent: 3.65, result: 23.36 },
  641: { percent: 3.65, result: 23.397 },
  642: { percent: 3.65, result: 23.433 },
  643: { percent: 3.65, result: 23.47 },
  644: { percent: 3.65, result: 23.506 },
  645: { percent: 3.65, result: 23.543 },
  646: { percent: 3.65, result: 23.579 },
  647: { percent: 3.65, result: 23.616 },
  648: { percent: 3.65, result: 23.652 },
  649: { percent: 3.65, result: 23.689 },
  650: { percent: 3.60, result: 23.4 },
  651: { percent: 3.60, result: 23.436 },
  652: { percent: 3.60, result: 23.472 },
  653: { percent: 3.60, result: 23.508 },
  654: { percent: 3.60, result: 23.544 },
  655: { percent: 3.60, result: 23.58 },
  656: { percent: 3.60, result: 23.616 },
  657: { percent: 3.60, result: 23.652 },
  658: { percent: 3.60, result: 23.688 },
  659: { percent: 3.60, result: 23.724 },
  660: { percent: 3.60, result: 23.76 },
  661: { percent: 3.60, result: 23.796 },
  662: { percent: 3.60, result: 23.832 },
  663: { percent: 3.60, result: 23.868 },
  664: { percent: 3.60, result: 23.904 },
  665: { percent: 3.60, result: 23.94 },
  666: { percent: 3.60, result: 23.976 },
  667: { percent: 3.60, result: 24.012 },
  668: { percent: 3.60, result: 24.048 },
  669: { percent: 3.60, result: 24.084 },
  670: { percent: 3.55, result: 23.785 },
  671: { percent: 3.55, result: 23.821 },
  672: { percent: 3.55, result: 23.856 },
  673: { percent: 3.55, result: 23.892 },
  674: { percent: 3.55, result: 23.927 },
  675: { percent: 3.55, result: 23.963 },
  676: { percent: 3.55, result: 23.998 },
  677: { percent: 3.55, result: 24.034 },
  678: { percent: 3.55, result: 24.069 },
  679: { percent: 3.55, result: 24.105 },
  680: { percent: 3.55, result: 24.14 },
  681: { percent: 3.55, result: 24.176 },
  682: { percent: 3.55, result: 24.211 },
  683: { percent: 3.55, result: 24.247 },
  684: { percent: 3.55, result: 24.282 },
  685: { percent: 3.55, result: 24.318 },
  686: { percent: 3.55, result: 24.353 },
  687: { percent: 3.55, result: 24.389 },
  688: { percent: 3.55, result: 24.424 },
  689: { percent: 3.55, result: 24.46 },
  690: { percent: 3.50, result: 24.15 },
  691: { percent: 3.50, result: 24.185 },
  692: { percent: 3.50, result: 24.22 },
  693: { percent: 3.50, result: 24.255 },
  694: { percent: 3.50, result: 24.29 },
  695: { percent: 3.50, result: 24.325 },
  696: { percent: 3.50, result: 24.36 },
  697: { percent: 3.50, result: 24.395 },
  698: { percent: 3.50, result: 24.43 },
  699: { percent: 3.50, result: 24.465 },
  700: { percent: 3.50, result: 24.5 },
  701: { percent: 3.50, result: 24.57 },
  702: { percent: 3.50, result: 24.605 },
  703: { percent: 3.50, result: 24.64 },
  704: { percent: 3.50, result: 24.675 },
  705: { percent: 3.50, result: 24.71 },
  706: { percent: 3.50, result: 24.745 },
  707: { percent: 3.50, result: 24.78 },
  708: { percent: 3.50, result: 24.815 },
  709: { percent: 3.45, result: 24.495 },
  710: { percent: 3.45, result: 24.53 },
  711: { percent: 3.45, result: 24.564 },
  712: { percent: 3.45, result: 24.599 },
  713: { percent: 3.45, result: 24.633 },
  714: { percent: 3.45, result: 24.668 },
  715: { percent: 3.45, result: 24.702 },
  716: { percent: 3.45, result: 24.737 },
  717: { percent: 3.45, result: 24.771 },
  718: { percent: 3.45, result: 24.806 },
  719: { percent: 3.45, result: 24.84 },
  720: { percent: 3.45, result: 24.875 },
  721: { percent: 3.45, result: 24.909 },
  722: { percent: 3.45, result: 24.944 },
  723: { percent: 3.45, result: 24.978 },
  724: { percent: 3.45, result: 25.013 },
  725: { percent: 3.45, result: 25.047 },
  726: { percent: 3.45, result: 25.082 },
  727: { percent: 3.45, result: 25.116 },
  728: { percent: 3.45, result: 25.151 },
  729: { percent: 3.40, result: 24.82 },
  730: { percent: 3.40, result: 24.854 },
  731: { percent: 3.40, result: 24.888 },
  732: { percent: 3.40, result: 24.922 },
  733: { percent: 3.40, result: 24.956 },
  734: { percent: 3.40, result: 24.99 },
  735: { percent: 3.40, result: 25.024 },
  736: { percent: 3.40, result: 25.058 },
  737: { percent: 3.40, result: 25.092 },
  738: { percent: 3.40, result: 25.126 },
  739: { percent: 3.40, result: 25.16 },
  740: { percent: 3.40, result: 25.194 },
  741: { percent: 3.40, result: 25.228 },
  742: { percent: 3.40, result: 25.262 },
  743: { percent: 3.40, result: 25.296 },
  744: { percent: 3.40, result: 25.33 },
  745: { percent: 3.40, result: 25.364 },
  746: { percent: 3.40, result: 25.398 },
  747: { percent: 3.40, result: 25.432 },
  748: { percent: 3.40, result: 25.466 },
  749: { percent: 3.35, result: 25.125 },
  750: { percent: 3.35, result: 25.159 },
  751: { percent: 3.35, result: 25.192 },
  752: { percent: 3.35, result: 25.226 },
  753: { percent: 3.35, result: 25.259 },
  754: { percent: 3.35, result: 25.293 },
  755: { percent: 3.35, result: 25.326 },
  756: { percent: 3.35, result: 25.36 },
  757: { percent: 3.35, result: 25.393 },
  758: { percent: 3.35, result: 25.427 },
  759: { percent: 3.35, result: 25.46 },
  760: { percent: 3.35, result: 25.494 },
  761: { percent: 3.35, result: 25.527 },
  762: { percent: 3.35, result: 25.561 },
  763: { percent: 3.35, result: 25.594 },
  764: { percent: 3.35, result: 25.628 },
  765: { percent: 3.35, result: 25.661 },
  766: { percent: 3.35, result: 25.695 },
  767: { percent: 3.35, result: 25.728 },
  768: { percent: 3.35, result: 25.762 },
  769: { percent: 3.30, result: 25.41 },
  770: { percent: 3.30, result: 25.443 },
  771: { percent: 3.30, result: 25.476 },
  772: { percent: 3.30, result: 25.509 },
  773: { percent: 3.30, result: 25.542 },
  774: { percent: 3.30, result: 25.575 },
  775: { percent: 3.30, result: 25.608 },
  776: { percent: 3.30, result: 25.641 },
  777: { percent: 3.30, result: 25.674 },
  778: { percent: 3.30, result: 25.707 },
  779: { percent: 3.30, result: 25.74 },
  780: { percent: 3.30, result: 25.773 },
  781: { percent: 3.30, result: 25.806 },
  782: { percent: 3.30, result: 25.839 },
  783: { percent: 3.30, result: 25.872 },
  784: { percent: 3.30, result: 25.905 },
  785: { percent: 3.30, result: 25.938 },
  786: { percent: 3.30, result: 25.971 },
  787: { percent: 3.30, result: 26.004 },
  788: { percent: 3.30, result: 26.037 },
  789: { percent: 3.25, result: 25.675 },
  790: { percent: 3.25, result: 25.708 },
  791: { percent: 3.25, result: 25.74 },
  792: { percent: 3.25, result: 25.773 },
  793: { percent: 3.25, result: 25.805 },
  794: { percent: 3.25, result: 25.838 },
  795: { percent: 3.25, result: 25.87 },
  796: { percent: 3.25, result: 25.903 },
  797: { percent: 3.25, result: 25.935 },
  798: { percent: 3.25, result: 25.968 },
  799: { percent: 3.25, result: 26.0 },
  800: { percent: 3.25, result: 26.033 },
  801: { percent: 3.25, result: 26.065 },
  802: { percent: 3.25, result: 26.098 },
  803: { percent: 3.25, result: 26.13 },
  804: { percent: 3.25, result: 26.163 },
  805: { percent: 3.25, result: 26.195 },
  806: { percent: 3.25, result: 26.228 },
  807: { percent: 3.25, result: 26.26 },
  808: { percent: 3.25, result: 26.293 },
  809: { percent: 3.20, result: 25.92 },
  810: { percent: 3.20, result: 25.952 },
  811: { percent: 3.20, result: 25.984 },
  812: { percent: 3.20, result: 26.016 },
  813: { percent: 3.20, result: 26.048 },
  814: { percent: 3.20, result: 26.08 },
  815: { percent: 3.20, result: 26.112 },
  816: { percent: 3.20, result: 26.144 },
  817: { percent: 3.20, result: 26.176 },
  818: { percent: 3.20, result: 26.208 },
  819: { percent: 3.20, result: 26.24 },
  820: { percent: 3.20, result: 26.272 },
  821: { percent: 3.20, result: 26.304 },
  822: { percent: 3.20, result: 26.336 },
  823: { percent: 3.20, result: 26.368 },
  824: { percent: 3.20, result: 26.4 },
  825: { percent: 3.20, result: 26.432 },
  826: { percent: 3.20, result: 26.464 },
  827: { percent: 3.20, result: 26.496 },
  828: { percent: 3.20, result: 26.528 },
  829: { percent: 3.15, result: 26.145 },
  830: { percent: 3.15, result: 26.177 },
  831: { percent: 3.15, result: 26.208 },
  832: { percent: 3.15, result: 26.24 },
  833: { percent: 3.15, result: 26.271 },
  834: { percent: 3.15, result: 26.303 },
  835: { percent: 3.15, result: 26.334 },
  836: { percent: 3.15, result: 26.366 },
  837: { percent: 3.15, result: 26.397 },
  838: { percent: 3.15, result: 26.429 },
  839: { percent: 3.15, result: 26.46 },
  840: { percent: 3.15, result: 26.492 },
  841: { percent: 3.15, result: 26.523 },
  842: { percent: 3.15, result: 26.555 },
  843: { percent: 3.15, result: 26.586 },
  844: { percent: 3.15, result: 26.618 },
  845: { percent: 3.15, result: 26.649 },
  846: { percent: 3.15, result: 26.681 },
  847: { percent: 3.15, result: 26.712 },
  848: { percent: 3.15, result: 26.744 },
  849: { percent: 3.10, result: 26.35 },
  850: { percent: 3.10, result: 26.381 },
  851: { percent: 3.10, result: 26.412 },
  852: { percent: 3.10, result: 26.443 },
  853: { percent: 3.10, result: 26.474 },
  854: { percent: 3.10, result: 26.505 },
  855: { percent: 3.10, result: 26.536 },
  856: { percent: 3.10, result: 26.567 },
  857: { percent: 3.10, result: 26.598 },
  858: { percent: 3.10, result: 26.629 },
  859: { percent: 3.10, result: 26.66 },
  860: { percent: 3.10, result: 26.691 },
  861: { percent: 3.10, result: 26.722 },
  862: { percent: 3.10, result: 26.753 },
  863: { percent: 3.10, result: 26.784 },
  864: { percent: 3.10, result: 26.815 },
  865: { percent: 3.10, result: 26.846 },
  866: { percent: 3.10, result: 26.877 },
  867: { percent: 3.10, result: 26.908 },
  868: { percent: 3.10, result: 26.939 },
  869: { percent: 3.05, result: 26.535 },
  870: { percent: 3.05, result: 26.566 },
  871: { percent: 3.05, result: 26.596 },
  872: { percent: 3.05, result: 26.627 },
  873: { percent: 3.05, result: 26.657 },
  874: { percent: 3.05, result: 26.688 },
  875: { percent: 3.05, result: 26.718 },
  876: { percent: 3.05, result: 26.749 },
  877: { percent: 3.05, result: 26.779 },
  878: { percent: 3.05, result: 26.81 },
  879: { percent: 3.05, result: 26.84 },
  880: { percent: 3.05, result: 26.871 },
  881: { percent: 3.05, result: 26.901 },
  882: { percent: 3.05, result: 26.932 },
  883: { percent: 3.05, result: 26.962 },
  884: { percent: 3.05, result: 26.993 },
  885: { percent: 3.05, result: 27.023 },
  886: { percent: 3.05, result: 27.054 },
  887: { percent: 3.05, result: 27.084 },
  888: { percent: 3.05, result: 27.115 },
  889: { percent: 3.00, result: 26.7 },
  890: { percent: 3.00, result: 26.73 },
  891: { percent: 3.00, result: 26.76 },
  892: { percent: 3.00, result: 26.79 },
  893: { percent: 3.00, result: 26.82 },
  894: { percent: 3.00, result: 26.85 },
  895: { percent: 3.00, result: 26.88 },
  896: { percent: 3.00, result: 26.91 },
  897: { percent: 3.00, result: 26.94 },
  898: { percent: 3.00, result: 26.97 },
  899: { percent: 3.00, result: 27.0 },
  900: { percent: 3.00, result: 27.03 }
}


self.addEventListener('message', async (event) => {
  const table = event.data.table
  console.log('Воркер обновления общих данных')

  for await (const item of table) {
    // "расходы РК" заполняются в зависимости от "расходы Баланс"
    const balance = +(+item.common_expenses.balance / 1000).toFixed() || 0
    item.common_expenses.pk = summarySheetPercent[balance].result * 1000

    // (c4+c5) | requests.chanel.pk+requests.chanel.seo
    const orderRang = +item.requests.chanel.pk + +item.requests.chanel.seo
    // (R4+S4+T4+U4) | common_expenses.balance+common_expenses.pk+common_expenses.seo+common_expenses.common
    // Расходы->Баланс + Расходы->РК + Расходы->SEO + Расходы->Алока и т.д
    const commonExpenses =
      +item.common_expenses.balance +
      +item.common_expenses.pk +
      +item.common_expenses.seo +
      +item.common_expenses.common

    // заявки
    const requestsTraffikPrice = Math.round((+item.common_expenses.balance + +item.common_expenses.seo) / +orderRang)
    const requestsCommonPrice = Math.round(commonExpenses / orderRang)
    item.requests.traffik_price = isFinite(requestsTraffikPrice) ? requestsTraffikPrice : 0
    item.requests.common_price = isFinite(requestsCommonPrice) ? requestsCommonPrice : 0
    // запись
    const orderTraffikPrice = +item.order.count === 0 ? +item.common_expenses.balance : Math.round(+item.common_expenses.balance / +item.order.count)
    const orderCommonPrice = +item.order.count === 0 ? commonExpenses : Math.round(commonExpenses / +item.order.count)
    const orderConversion = +item.order.count === 0 ? Math.round(orderRang * 100) : Math.round(+item.order.count / orderRang * 100)
    item.order.traffik_price = isFinite(orderTraffikPrice) ? orderTraffikPrice : 0
    item.order.common_price = isFinite(orderCommonPrice) ? orderCommonPrice : 0
    item.order.conversion = isFinite(orderConversion) ? orderConversion : 0
    // Пришёл в СЦ
    const cameToSCTraffikPrice = +item.came_to_sc.count === 0 ? +item.common_expenses.balance : Math.round(+item.common_expenses.balance / +item.came_to_sc.count)
    const cameToSCCommonPrice = +item.came_to_sc.count === 0 ? commonExpenses : Math.round(commonExpenses / +item.came_to_sc.count)
    const cameToSCConversion = +item.came_to_sc.count === 0 ? Math.round(orderRang * 100) : Math.round(+item.came_to_sc.count / orderRang * 100)
    item.came_to_sc.traffik_price = isFinite(cameToSCTraffikPrice) ? cameToSCTraffikPrice : 0
    item.came_to_sc.common_price = isFinite(cameToSCCommonPrice) ? cameToSCCommonPrice : 0
    item.came_to_sc.conversion = isFinite(cameToSCConversion) ? cameToSCConversion : 0
    // Клиент закрыт
    const orderClosedTraffikPrice = +item.order_closed.count === 0 ? +item.common_expenses.balance : Math.round(+item.common_expenses.balance / +item.order_closed.count)
    const orderClosedCommonPrice = +item.order_closed.count === 0 ? commonExpenses : Math.round(commonExpenses / +item.order_closed.count)
    const orderClosedConversion = +item.order_closed.count === 0 ? Math.round(orderRang * 100) : Math.round(+item.order_closed.count / orderRang * 100)
    item.order_closed.traffik_price = isFinite(orderClosedTraffikPrice) ? orderClosedTraffikPrice : 0
    item.order_closed.common_price = isFinite(orderClosedCommonPrice) ? orderClosedCommonPrice : 0
    item.order_closed.conversion = isFinite(orderClosedConversion) ? orderClosedConversion : 0

    // вал
    item.val = Math.round(+item.revenue - +item.expenses) || 0
    // средний чек
    item.wed_check = Math.round(+item.val / +item.orders) || 0
    // дельта
    item.delta = Math.round(+item.wed_check - +item.came_to_sc.common_price) || 0

    // прибыль
    item.profit = Math.round(+item.val * 0.65 - +item.came_to_sc.count * 70 - commonExpenses) || 0
    const spz = Math.round(+item.profit / +item.orders)
    item.spz = isFinite(spz) ? spz : 0
  }

  self.postMessage(table)
})
